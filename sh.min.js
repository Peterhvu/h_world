function toggleMaskContent(){$("#content").toggleClass("hide"),$("#content.hide").length?(exitFullScreenVideo(),$.fancybox&&$.fancybox.close(),$("#content").after('<iframe class="mask" src="Mask.html" width="100%" height="800px" frameborder="0"></iframe>')):$(".mask").remove()}function reCenterContent(){if(window.innerWidth>500){var e=window.innerWidth%($(".itm").outerWidth(!0)+6)/2;imgSection.css({"margin-left":e,"margin-right":e})}}function getMenuList(){var e="https://peterhvu.github.io/h_world/";appName.length>4?e+="seg2.json":e+="seg.json",$.getJSON(e,function(e){if(menuList=e,menuList.length>0){var n=$(document.createElement("ul")).addClass("segments").hide();$.each(menuList,function(e,t){n.append('<li><a href="'+t+'.html">'+t)}),n.insertAfter("h1").slideToggle()}else $("#segmentInput").show()})}function toggleMenu(){menuList?$(".segments").slideToggle():getMenuList()}function loadNextPage(){$(".paging.selectedBG").length>0?$(".paging.selectedBG").is(":last-child")?(paginNextSet(),loadNextPage()):$(".paging.selectedBG + .paging").click():$("#vLinks .paging:first").click()}function paginPreSet(){var e=parseInt($("#vLinks .paging").first().text());e>1&&($(".paging.selectedBG").removeClass("selectedBG"),resetPagingStartWith(e-$("#vLinks .paging").length))}function paginNextSet(){$(".paging.selectedBG").removeClass("selectedBG");var e=parseInt($("#vLinks .paging").last().text());resetPagingStartWith(e+1)}function resetPaging(){resetPagingStartWith(pagingFirst)}function resetPagingStartWith(e){for(var n=$("#vLinks").empty(),t=e;t<e+10;t++)n.append('<div class="paging" onclick="loadPage(this);">'+t)}function enterFullScreenVideo(e){isIOS&&(e.play(),e.addEventListener("loadedmetadata",function(){e.webkitEnterFullscreen()})),isAndrd&&e.play().mozRequestFullScreen()}function exitFullScreenVideo(){var e=$("video.activeVidPlayer").get(0);e&&(isIOS?e.webkitExitFullScreen():ua.indexOf("firefox")&&document.fullscreenElement&&document.exitFullscreen(),e.pause())}function autoPlayNextVideo(){exitFullScreenVideo(),$.fancybox&&$.fancybox.close(),setTimeout(function(){$(".itm.selectedBG").next().click()},1e3)}function expandVideo4Item(e){var n=e.find("video")[0];return n&&(isIOS?enterFullScreenVideo(n):$.fancybox&&($.fancybox.open(n),n.play())),null!=n}function insertFancyBox(){$("head>script").after('<script src="src/jquery.fancybox.min.js"> </script><link rel="stylesheet" type="text/css" href="src/jquery.fancybox.min.css">')}function getJsonUsingYqlHtml(e,n,t){alert("YQL discountinued.")}function getJsonUsingYqlJson(e,n){alert("YQL discountinued.")}function getJsonUsingYqlXml(e,n){alert("YQL discountinued.")}function getJsonBins(e,n){$.getJSON(myJsonBaseUrl+e,function(e){n(e)})}function updateJsonBinOfLikes(e,n,t){getJsonBins(e,function(i){i.indexOf(n)<0?i.push(n):i.splice(i.indexOf(n),1),$.ajax({type:"PUT",url:myJsonBaseUrl+e,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),success:function(e){t(!0)}}).fail(function(e,n,i){t(!1)})})}function loadSavedTag(e,n){if($("h1").after('<select class="popularTags">'),$(".popularTags").change(function(){$("#searchBox").val(this.value),startSearch()}),e.length>0){var t=[];e.forEach(function(e){t.push('<option value="'+e+'">'+e+"</option>")}),$(".popularTags").html(t)}n.length>0&&getJsonBins(n,function(e){var n=[],t=[];e.forEach(function(e){var i=atob(e);n.push('<option value="'+i+'">'+i+"</option>"),t.push(i)}),$(".popularTags").append(n),AutocomleteSearchWithTags(t)})}function updateTag(e,n,t){var i=!0,a=btoa(n),o=$(".popularTags");getJsonBins(e,function(s){t&&s&&s.indexOf(a)<0?(s.push(a),o.length>0&&o.append("<option value="+n+">"+n)):!t&&s&&s.indexOf(a)>=0?s.splice(s.indexOf(a),1):i=!1,i&&$.ajax({type:"PUT",url:myJsonBaseUrl+e,contentType:"application/json; charset=utf-8",data:JSON.stringify(s),success:function(e){imgSection.prepend("Search ",t?"saved":"deleted")}})})}function AutocomleteSearchWithTags(e){$("#searchBox").autocomplete({source:e,select:startSearch})}var menuList,ua=navigator.userAgent.toLowerCase(),isIOS=null!=ua.match(/i(phone|pod|pad)/),isIPad=null!=ua.match(/ipad/),isAndrd=null!=ua.match(/android/),isMac=null!=ua.match(/macintosh/),appName=window.location.pathname.split("/").pop().replace(".html",""),imgSection=$("#panes"),myJsonBaseUrl="https://api.myjson.com/bins/",pagingFirst=1,isYqlDiag=!1;console.log("userAgent, ua: ",ua),console.log("isIOS: ",isIOS,"isIPad: ",isIPad," isAndrd: ",isAndrd," isMac: ",isMac),$(document).ready(function(){document.title=appName,$("h1").html(appName),$("html").addClass(appName),isIOS&&($(".clearout").remove(),$(".androidOnly").remove(),$("linkHi").removeAttr("target")),$("h1").after('<a class="homeBtn" href="OneWebApp.html"> &#8962; </a><div class="menuBtn" onclick="toggleMenu();">&#9776;</div>'),document.onkeyup=function(e){"INPUT"!=e.originalTarget.tagName&&(32==e.keyCode?toggleMaskContent():"f"==e.key&&$.fancybox&&!$(".fancybox-is-open").length&&$(".itm.selectedBG").click())},document.onkeydown=function(e){if("INPUT"!=e.originalTarget.tagName&&32==e.keyCode)return!1},resetPaging()}),window.onresize=function(e){reCenterContent()},$(document).on("afterClose.fb",function(e,n,t){$("iframe.activeVidPlayer").remove(),$("video.activeVidPlayer").get(0)&&$(".activeVidPlayer").css("display","block").get(0).pause()}),jQuery.ajaxPrefilter(function(e){!isIOS&&e.crossDomain&&jQuery.support.cors&&e.url.indexOf("cloudflare")<0&&e.url.indexOf("myjson")<0&&e.url.indexOf("ntrex.")<0&&e.url.indexOf("github")<0&&(e.url="https://cors-anywhere.herokuapp.com/"+e.url)});